DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Code_First_Exercise.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202307170757367_Initial-Migration-Add-Tables-Videos-Genres'
BEGIN
    CREATE TABLE [dbo].[Genres] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Videos] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [ReleaseDate] [datetime] NOT NULL,
        CONSTRAINT [PK_dbo.Videos] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoGenres] (
        [Video_Id] [int] NOT NULL,
        [Genre_Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoGenres] PRIMARY KEY ([Video_Id], [Genre_Id])
    )
    CREATE INDEX [IX_Video_Id] ON [dbo].[VideoGenres]([Video_Id])
    CREATE INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]([Genre_Id])
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202307170757367_Initial-Migration-Add-Tables-Videos-Genres', N'Code_First_Exercise.Migrations.Configuration',  0x1F8B0800000000000400ED59CD6EE33610BE17E83B083AB54562E5E7D21AF62E5227298C6EE2204E82DE025A1A3B44294A25A9C0DEA24FD6431FA9AFD0A1FE454AB6EC2EB2455B04086C72FEE7E37086FEF3F73F46EFD721735E41481AF1B17B3A38711DE07E1450BE1ABB895A1E7FEBBE7FF7E517A3AB205C3B4F05DDB9A6434E2EC7EE8B52F1D0F3A4FF0221918390FA2292D1520DFC28F4481079672727DF79A7A71EA008176539CEE83EE18A86907EC1AF9388FB10AB84B09B280026F375DC99A7529D5B12828C890F63778214CFD75448F57CB506E15309AE73C1284153E6C096AE43388F145168E8F051C25C8988AFE6312E10F6B08901E9968469AED4816145DED7979333ED8B573116A2FC44AA28DC53E0E9791E1CCF643F28C46E193C0CDF1586596DB4D76908C7EE0FC0057A6E6A1A4E98D054ADE11DA44C478EDE3A4EB78E8BADA31212881CFD87540953898031874409C28E9CBB64C1A8FF236C1EA29F818F79C258DD46B412F71A0BB87427A21884DADCC332B77C1AB88ED7E4F34CC692ADC693B935E5EAFCCC756E513959302821500BC15C4502D05510444170479402C1B50C488368693774E9FF8536C41C9E1FD7B921EB0FC057EA65ECE247D7B9A66B088A95DC82474EF1B821931209584A6EC92B5DA5F619EA9E680091749D7B60E9B67CA171760006E9D6739A3424B81651781FB182255F7F7E2062050A0D8E5A36E751227CC398915781692BC45249FB422C65FA1F629F0362861204141009976861A14B7F7EA05AB7E55C5FB816683C14AE05225BE15A60B90F5C2FA48C7C9ADA50C76BA1BFE9CE150F9C6DC66499289DC06C2032698C5844CD63F71B2B3E1D02CBC35809CC0BF5568123AFE68D7D26F156558422D82A473FA68BB0562DE713EFCAFC88CA1C29A6ED5AE81C9491D22ACE4DD32DD79BEC4501B3D8F3501AEC354F0D1925746A246DD032CFFF8EE496F656A67A3D4514E9AC89286C34CB4BD3AD16FC9649AC7A222F6B8A8AE6C9EBE89E4637248EB146D4BAA97CC599E7ADD4F17CFF1623CC6478BE6CE9344A6B4B4D58F1C80A8CDDEC0E48EB3CD616B220BA944C82D0226B40B6034F85AA062AED4C15282BC8F5E78CA5B3E531A55411BC46A7422CDAA97F60E6D9E64B3B59C28868B93D26114B42DE75036DE3CEEE833A7FB6624B187986E1667C3C2B400650CD70F74A467E70FE6E32B28AB07F323AF83E7732BA24346EDEBAA0C6C6DB27B759A35A325C56E01E692C695B93D57A7C74996DEB7E8D8A6DC7A5579633516DB9D6712915EF69537E051C68532A644F9BCCBBC44EA575A598242590CAABC5B842467939EF37A537EA7B46E23A68FB2B060A6BFB7C231584034D3098FFC2268C22742B821BC2E912A4CA5A7A17E7E43363CEFFE7CCDC9E9401EB3378BFF950427548778E1DBBDAFA2D73087F25C27F21E2AB90ACBFAE4BB2678D3D27C8FF74AC7ACD65017E56BBE7B2FDE27E3050B714529BB8ABC2EDCE57A5A696356B9899F200D663F7D79469E84C7F7A2EF88E9C99C0F232744E9CDFF6CE6665F67ECA0BBE3D941F36C0B65E86E69CB27B723DB5EEE019BF44002A702EFCACCA4E88F44960474C5F505BB5E7E3A169429F8157BF1CC312843E8B84E13D2695C09BCC6A78EE04E53E8D096B786D5FC67D2A8876A99467EE5C420C5C9706DBC13EDAB6F51EA56823BCBB02D0F928B003386D1D4B2D7576D65A13F62F034EFF54BE2D70B635889F1C38EDAF49F604DFE3B9A8FBB528EB0FF14E5BE8F29455C58E4793D697A4EE87A436C9ED2F3AED92BB0CAF6F76EAE87061E76B56F90CB5FD51AB63F6B10BBE3515EF7CCC6AB86D4E68FDDFB17A395B3C98ED70B67DA8B28B94F51EF356CEEEF168674F5278426BBF8A628590745589D0BF9172F01B67B3A499F265541409C3A282C468646E40116C1FC9855074497C85DB3E4899FEA4F04458822457E10282299F252A4E14BA0CE182357EA2D0A5669BFEF465B269F36816A7AFFF9FC2053493EA0E78C6BF4F280B4ABBAF5B7AA90E11BA86E5BDBECEA5D23DFF6A534ABA8D784F4179F8CAD2FB0061CC50989CF1397985436C7B94F00156C4DF140371B790DD8968867D7449C94A9050E6322A7EFC8A180EC2F5BBBF0064A90B261C200000 , N'6.1.3-40302')
END

IF @CurrentMigration < '202307170804092_PopulateGeneresDatabase'
BEGIN
    INSERT INTO Genres (Name) VALUES ('Horror')
    INSERT INTO Genres (Name) VALUES ('Comedy')
    INSERT INTO Genres (Name) VALUES ('Action')
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202307170804092_PopulateGeneresDatabase', N'Code_First_Exercise.Migrations.Configuration',  0x1F8B0800000000000400ED59CD6EE33610BE17E83B083AB54562E5E7D21AF62E5227298C6EE2204E82DE025A1A3B44294A25A9C0DEA24FD6431FA9AFD0A1FE454AB6EC2EB2455B04086C72FEE7E37086FEF3F73F46EFD721735E41481AF1B17B3A38711DE07E1450BE1ABB895A1E7FEBBE7FF7E517A3AB205C3B4F05DDB9A6434E2EC7EE8B52F1D0F3A4FF0221918390FA2292D1520DFC28F4481079672727DF79A7A71EA008176539CEE83EE18A86907EC1AF9388FB10AB84B09B280026F375DC99A7529D5B12828C890F63778214CFD75448F57CB506E15309AE73C1284153E6C096AE43388F145168E8F051C25C8988AFE6312E10F6B08901E9968469AED4816145DED7979333ED8B573116A2FC44AA28DC53E0E9791E1CCF643F28C46E193C0CDF1586596DB4D76908C7EE0FC0057A6E6A1A4E98D054ADE11DA44C478EDE3A4EB78E8BADA31212881CFD87540953898031874409C28E9CBB64C1A8FF236C1EA29F818F79C258DD46B412F71A0BB87427A21884DADCC332B77C1AB88ED7E4F34CC692ADC693B935E5EAFCCC756E513959302821500BC15C4502D05510444170479402C1B50C488368693774E9FF8536C41C9E1FD7B921EB0FC057EA65ECE247D7B9A66B088A95DC82474EF1B821931209584A6EC92B5DA5F619EA9E680091749D7B60E9B67CA171760006E9D6739A3424B81651781FB182255F7F7E2062050A0D8E5A36E751227CC398915781692BC45249FB422C65FA1F629F0362861204141009976861A14B7F7EA05AB7E55C5FB816683C14AE05225BE15A60B90F5C2FA48C7C9ADA50C76BA1BFE9CE150F9C6DC66499289DC06C2032698C5844CD63F71B2B3E1D02CBC35809CC0BF5568123AFE68D7D26F156558422D82A473FA68BB0562DE713EFCAFC88CA1C29A6ED5AE81C9491D22ACE4DD32DD79BEC4501B3D8F3501AEC354F0D1925746A246DD032CFFF8EE496F656A67A3D4514E9AC89286C34CB4BD3AD16FC9649AC7A222F6B8A8AE6C9EBE89E4637248EB146D4BAA97CC599E7ADD4F17CFF1623CC6478BE6CE9344A6B4B4D58F1C80A8CDDEC0E48EB3CD616B220BA944C82D0226B40B6034F85AA062AED4C15282BC8F5E78CA5B3E531A55411BC46A7422CDAA97F60E6D9E64B3B59C28868B93D26114B42DE75036DE3CEEE833A7FB6624B187986E1667C3C2B400650CD70F74A467E70FE6E32B28AB07F323AF83E7732BA24346EDEBAA0C6C6DB27B759A35A325C56E01E692C695B93D57A7C74996DEB7E8D8A6DC7A5579633516DB9D6712915EF69537E051C68532A644F9BCCBBC44EA575A598242590CAABC5B842467939EF37A537EA7B46E23A68FB2B060A6BFB7C231584034D3098FFC2268C22742B821BC2E912A4CA5A7A17E7E43363CEFFE7CCDC9E9401EB3378BFF950427548778E1DBBDAFA2D73087F25C27F21E2AB90ACBFAE4BB2678D3D27C8FF74AC7ACD65017E56BBE7B2FDE27E3050B714529BB8ABC2EDCE57A5A696356B9899F200D663F7D79469E84C7F7A2EF88E9C99C0F232744E9CDFF6CE6665F67ECA0BBE3D941F36C0B65E86E69CB27B723DB5EEE019BF44002A702EFCACCA4E88F44960474C5F505BB5E7E3A169429F8157BF1CC312843E8B84E13D2695C09BCC6A78EE04E53E8D096B786D5FC67D2A8876A99467EE5C420C5C9706DBC13EDAB6F51EA56823BCBB02D0F928B003386D1D4B2D7576D65A13F62F034EFF54BE2D70B635889F1C38EDAF49F604DFE3B9A8FBB528EB0FF14E5BE8F29455C58E4793D697A4EE87A436C9ED2F3AED92BB0CAF6F76EAE87061E76B56F90CB5FD51AB63F6B10BBE3515EF7CCC6AB86D4E68FDDFB17A395B3C98ED70B67DA8B28B94F51EF356CEEEF168674F5278426BBF8A628590745589D0BF9172F01B67B3A499F265541409C3A282C468646E40116C1FC9855074497C85DB3E4899FEA4F04458822457E10282299F252A4E14BA0CE182357EA2D0A5669BFEF465B269F36816A7AFFF9FC2053493EA0E78C6BF4F280B4ABBAF5B7AA90E11BA86E5BDBECEA5D23DFF6A534ABA8D784F4179F8CAD2FB0061CC50989CF1397985436C7B94F00156C4DF140371B790DD8968867D7449C94A9050E6322A7EFC8A180EC2F5BBBF0064A90B261C200000 , N'6.1.3-40302')
END

IF @CurrentMigration < '202307170919287_ModifyVideosToHaveonlyOneGenre'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Videos_Video_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id]
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Video_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Video_Id] ON [dbo].[VideoGenres]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]
    ALTER TABLE [dbo].[Videos] ADD [Genre_Id] [int]
    CREATE INDEX [IX_Genre_Id] ON [dbo].[Videos]([Genre_Id])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id])
    DROP TABLE [dbo].[VideoGenres]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202307170919287_ModifyVideosToHaveonlyOneGenre', N'Code_First_Exercise.Migrations.Configuration',  0x1F8B0800000000000400ED595B6FDB36147E1FB0FF20E8691B12CB495E56C36E9139C960ACB9204A82BD19B474EC10A3288DA402BBC37ED91EFA93F61776A8BB48D991BDB51DB0A140E190E77E3E9E8BFDE71F1FC7EFD611735E40481AF3897B3218BA0EF0200E295F4DDC542D8FBF77DFBDFDFAABF16518AD9DA792EE4CD321279713F759A964E47932788688C841440311CB78A906411C79248CBDD3E1F08D7772E2018A705196E38CEF53AE6804D91FF8E734E601242A25EC3A0E81C9E21C6FFC4CAA73432290090960E24E91627E458554F3CB3588804A709D7346099AE2035BBA0EE13C5644A1A1A34709BE12315FF9091E10F6B04900E9968469AECC81514DDED797E1A9F6C5AB194B51412A551CED29F0E4AC088E67B21F1462B70A1E86EF12C3AC36DAEB2C8413F747E0023D37358DA64C68AACEF00E32A623475F1D6757C7E5D5510509448EFE87542953A98009875409C28E9CBB74C168F0136C1EE25F804F78CA58D346B412EF5A07787427E20484DADCC3B2B07C16BA8ED7E6F34CC68AADC193BB35E3EAECD4756E50395930A820D00881AF6201E82A08A220BC234A81E05A066441B4B41BBAF4FFA536C41CBE1FD7B926EBF7C057EA79E2E247D7B9A26B08CB93C282474EF1B921931229584A6EC80B5D65F619EA9E6808B1749D7B60D9B57CA649FE0006D9D5BCC8F49588A3FB98951CF9F1FC818815283437B6EFFC38158161C9D8AB91B4135F99A07DF19531FD8FAF2F812F4309A20988840BB4B0D4A53F3F50ADDB72AE2F560B281E06D5128E5D502D61DC07AAE752C601CD0C6862B550DEF6E49287CE0E4BF21C54F6631E1093344114A2DE89FB9D15996E79D523ACE5159168CB1B0E0627A68F0D6FECF788ED54118A40AB1DFD901DC25A75BC4D6C92C5F394054A4CEBB5501F54339D587AEA38B7ADB79C6FB39795CB622F8269B0373C356494B8695074C0CA7CF9BB735B195BDBE9F5935066B321A10C945956DA2E7560B74A603D0879F924544E4CDE9691697C4D92046B4363842A4E1CBF989F8EFDFDE78A2897E105B263BCA8ACAD3461A5232B306EF3DA9FD577AC296441740999869145D682EB162C95AA5A88B4135522AC24D79F7396AD738E29A58EE0153A1561B1CEFC0333CF365F36BE12464447D798C62C8DF8B6CEB38B3BEF034DFEFCC49630F60CC3CDF87856800CA09AE1EE958CE2DDFCDD64E4D560FF646CE1FBD2C9D826A1D5719B825A179F3FB9ED1AD591E1B2FAF6C86249DA2B55BABC76CDBAED326BC7A3577673195D39D6F1A8F4EE6752D13B0E34696F63B03286341B6366528F64D538D6C751B3F9D8B9B77A90495221AFEA4546CF1917F5BFDF2EDF6A083989EBA0EF2F18616C06FE462A88069A60E0FFCAA68C22D66B826BC2E912A4CA677F17B7E953E3DB807FCF66EE4919B23EEBF967DF5EA80EE9ABFBC96BF3FF8E8585BF10113C13F14D44D6DF3625D94BC99EABE67F3A56BD16B8103FAB5E0B5CD7DA36373CB7B687190F613D717FCB9846CEECE779C977E4DC0A7CA22367E8FC7E58CE0FDBD91A8D69BFB5CA9EED0F59F6106820340E08C31A2A95C02A6A75E73B5CE0039A10D6B2D96E217DD0ABE357C9336F2E2001AE61D972AB8FA25DBDB2926A3CA3D77CDF7371B517861E9BE9F6C534EF2EF822163AB13918B7EC689D4BEBF69DB54B72F7FEF809F7D996F78DC5E4D50DD65E7B3FCDCE6ACF058898C62F0108564957B5083DEA70085A58A968667C1997A0352C2A498C7A760D8A603124E742D12509145E072065F64DDA136129925C460B0867FC365549AAD0658816ACF5CD9C86FE2EFDD962DEB6797C9B64DF7AFD132EA09954D7F35BFE434A5958D97D65D7F36D22F49B2A3A97CEA5D21D6CB5A924DDC4BCA7A0227C552978802861284CDE729FBCC021B63D4A780F2B126CCAF16EBB90D713D10EFBF882929520912C64D4FCFAD72D4FFFBCF5F62F6DB609ED101B0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '202307170924392_AddClassificationColumnToVideosTable'
BEGIN
    ALTER TABLE [dbo].[Videos] ADD [Classification] [int] NOT NULL DEFAULT 0
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202307170924392_AddClassificationColumnToVideosTable', N'Code_First_Exercise.Migrations.Configuration',  0x1F8B0800000000000400ED59CD6EE33610BE17E83B083AB54562D9D94B1BD8BB489D6461344E8228097A0B6869EC10A52895A4027B8B3E590F7DA4BE4287FA17293BB2BB3F055A2CB0B0C899E1CCF09B3FE6AF3FFE1CBF5B47CC79012169CC27EE6830741DE0411C52BE9AB8A95A1E7FEFBE7BFBF557E38B305A3B8F25DD1B4D879C5C4EDC67A59253CF93C13344440E221A8858C64B3508E2C82361EC9D0C873F78A3910728C245598E33BE4BB9A211641FF8398D7900894A099BC7213059ACE38E9F4975AE49043221014CDC29523C5D5221D5D3C51A444025B8CE19A30455F1812D5D87701E2BA250D1D30709BE12315FF9092E1076BF4900E9968469AECC80D39ABCAF2DC3136D8B573396A28254AA38DA53E0E84DE11CCF643FC8C56EE53C74DF05BA596DB4D5990B27EE7BE0022D374F3A9D32A1A93ADD3BC8988E1CBD759C6D1D975B4715241039FA1F52A54CA502261C5225083B726ED305A3C14FB0B98F7F013EE129634D1D514BDC6B2DE0D2AD8813106A7307CB42F359E83A5E9BCF33192BB6064F6ED68CAB3727AE738D879305830A020D17F82A1680A682200AC25BA21408AE6540E644EB74E32CFD7F791A620EE3C775E6647D057CA59E272EFE749D4BBA86B05C293478E014C30D999448C13AE49ABCD055A69F71DC230D2196AE73072CDB96CF34C90360906D3D15377D29E2E82E662547BEFC744FC40A14AA1BDB7B7E9C8AC0D064ECD548DA89AF4CD0BEF8CA98FEC7D797C0977108A209888473D4B03C4BFFBEA7FA6CCBB8DDB2A68C48499734287259A1BA46A8B9F59AE4AD515080FCB0202881DE15046580F40B82346A848069DC4C5E32B2AAABCE7EB1D196F6518304A11182601B845213C46DD7CF215A80284CF367578F1777AEF348588A9F43EBA25AD4EF6FAECE2BDAD16EDADBABB3FBD9F5C3BCA23FB17D9F7BB9B97826651CD0CC33CDFC535C7BFBB80B1E3A3B305083B348617374214DD06978E313F73B4BFD6E795562ADE515186CCB1B0E0623D3C28635768EC5164911CA2B87E1A11FB24558AB0E4C61E353C04A16916F6AAF85FAA09A8184E5A446785B7BCBF8367B598D2CF6C299067BC352434619B10D8A8E8036B3F9EEBBAD94ADF5F4FA49286FB321A17494592ADA2675648DEA02EBE6D6CBBBDBB20BF6B6B4C1E33949120CD2465B5CAC387ED1131FFBFBF78A512EC30B6447CB58695B9D84D58BACC0D8CD7356968EB04E9005D1096E1A4616590BAE5BB0541ED542A47D5125C24A72FDBBC8BCDB7A57534AEDC14B342AC2029CD907E63DDB7CD9484218111D9DC0346669C4B77513BBB8F3DADEE4CF576C0963CF50DCF48F6739C800AAE9EE5E9751C4CD3FBD8C3C1BEC7F195BF8BEF4656C93D0EAA29A825A1BFDE5991D4553A4B9F7F921D3CE7C1DB829737A0F6C94A4BD00A09376D754D44EDEB63F7A612697D1851CED8FEADCFD542A2AD2812AEDAD0CE6DB9066CDD14CEA16BB6A41FB186A9634FBEEADCA669254C8AB2A9C51C9C64555E9F7EAD32A333989EBA0ED2FE8612C31FE462A88069A60E0FFCAA68C22D66B8239E1740952E50DB07B321C9D18EF46FF9E371C4FCA90F579C8F9EC732ED52E7D7592DD73526C8EB6FC8588E099886F22B2FEB629C91E5FF77C94F84FFBAAD7A81FE26FF5F146FDCCFE3D25D5D9A821C39A6E6638B8AE27EE6F19D3A933FBF9A9E43B726E0406FBA933747E3F0C3D87CD948D12B7DFD867CF1E870CA30859101A518461369638F353BBCEDF0ACA039A10D6D2D92E467DE240FBAF9267EE9C43025C03BC65569F837655DD4AAA1190AFD9BEE7606D0F343D26E7ED83735EA730B616FA6273306E99213B87EAED337597E4EEF9F613CEDB2DEB1B83D3AB13B63D967F9A99DAEE3010318DBF3E2158255DD52274D3C4216861A5A299F1655C82D6D0A82431F2D91C14C1B44ACE84A24B1228DC0E0073A57EBD2D5EBA2EA20584337E93AA24556832440BD67A0DD6D0DF757EF670D0D6797C9364EFA11FC3045493EACA70C37F4C290B2BBD2FED7CBE4D848EA9A206EABB54BA16AE3695A4EB98F71454B8AF4A05F710250C85C91BEE93173844B7070957B022C1A66C14B70B79FD22DA6E1F9F53B2122492858C9A1F3F11C361B47EFB376CE7CD53841D0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '202307191825174_AddedFewChangesasPerItterationExercise'
BEGIN
    ALTER  TABLE   dbo.Videos  DROP    CONSTRAINT[DF__Videos__Classifi__48CFD27E]
    IF object_id(N'[dbo].[FK_dbo.Videos_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[Videos]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[Videos]
    EXECUTE sp_rename @objname = N'dbo.Videos.Genre_Id', @newname = N'GenreId', @objtype = N'COLUMN'
    ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [PK_dbo.Genres]
    CREATE TABLE [dbo].[Tags] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Tags] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[TagVideos] (
        [Tag_Id] [int] NOT NULL,
        [Video_Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.TagVideos] PRIMARY KEY ([Tag_Id], [Video_Id])
    )
    CREATE INDEX [IX_Tag_Id] ON [dbo].[TagVideos]([Tag_Id])
    CREATE INDEX [IX_Video_Id] ON [dbo].[TagVideos]([Video_Id])
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Id] [tinyint] NOT NULL
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Name] [nvarchar](max) NOT NULL
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Classification] [tinyint] NOT NULL
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [GenreId] [tinyint] NOT NULL
    ALTER TABLE [dbo].[Genres] ADD CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    CREATE INDEX [IX_GenreId] ON [dbo].[Videos]([GenreId])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_GenreId] FOREIGN KEY ([GenreId]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[TagVideos] ADD CONSTRAINT [FK_dbo.TagVideos_dbo.Tags_Tag_Id] FOREIGN KEY ([Tag_Id]) REFERENCES [dbo].[Tags] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[TagVideos] ADD CONSTRAINT [FK_dbo.TagVideos_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202307191825174_AddedFewChangesasPerItterationExercise', N'Code_First_Exercise.Migrations.Configuration',  0x1F8B0800000000000400ED5ADB6EE336107D2FD07F10F4D416499464B1401BD8BBC83AC9C2D83809E224E85BC048B44394A254910AEC16FDB23EF493FA0B1DEA2E5E6CC971B217140B2C6292339C199E992167F4EFDFFF0CDE2F42EA3CE18493880DDD83BD7DD7C1CC8F02C2E6433715B3DD9FDDF7EFBEFF6E701A840BE7AE5CF746AE034AC687EEA310F191E771FF118788EF85C44F221ECDC49E1F851E0A22EF707FFF17EFE0C0C3C0C2055E8E33B84E992021CE7EC0CF51C47C1C8B14D1491460CA8B719899665C9D0B14621E231F0FDD11ACB83F230917F7A70B9CF88463D739A6048128534C67AE83188B041220E8D12DC75391446C3E8D6100D19B658C61DD0C5149952970542FEFAACBFEA1D4C5AB094B567ECA4514F66478F0A6308EA7926F6462B7321E98EF14CC2C9652EBCC8443F723660968AEEE7434A2895C6534EF5E46B4E3C8A9DD6C6AB79CDAA92001C891FF60554A459AE021C3A94810DD71AED2074AFC4F787913FD86D990A5943665042961AE350043574914E3442CAFF1AC907C1CB88ED7A6F354C28AAC4193ABF5612940ED0BD81B3D505C21C05B492EFF2F19008CC0255C678216E798CDC5E3D0853F5DE78C2C70508E145C6F19010F022291A41D76BD404F649E1D83B2FF1D0970C45DE71AD36C9A3F923807F95E36755F9CE6591285D7112D29F2E1FB1B94CCB100F9237D6E1AA589AF4832F06AB4ACC450C6A82F8632A2AF1B436326DE1C1A8EB36182A988120C26C6091238B84242E084491E3833E2330177F8F6ED5600A7EC0AF0C288E31324AACDE5DF3724ECCF2B83D733DD6E4411E76446FC220816F690B057A73676ADC27336F3ACD27B4C9E557A5D57416ED0DCECE130715F06805A8C7A54F3EFC6D4B3DC1BF8F4756E20F9DFB55F25976C2175AC05960A6F03E6BA012B0D1BB0525D77CCCF2860BF52B41FE2DADCB60A3E30798013BA84236A04B1B6DD27387CC049A1D9747C7E777AED3A7788A6F0735F3BA5D6EA8F97E727D5DA83D56BAFCE8F6FC617B7936AFDA16EFADCC8CDC163CE239F648669A2A18869EDED4E59E0AC087075E42D92FE042C4862B0191CF8D0FD4913DFCCAF0A5535BF22C0B6F91DB8AAA35FB213C84E023BC77E7EA11E21EEA340F704B044D01E81D88013E99C88C2FB82C3811326F44042984F6244ED522B241DA38F14A962AECE9CE018331938ECB6EFB26B956CF5ADAB1D142BAD33CAC06BA06735A81A71C486015350A92190259AEE8032A5BE7EF8B42A9707303088007354DE072CFFC806F14218E213BC2D8B10C58BE8AC4A2E994EB1689E16C4DC3A5AB65D4153BC4D5E866C8DBCD07C0D797ECFD088B33350481B4652B62FAF458D15865B930AC6D531A612B4565183F3EAA8D2E050DA580D0E6D953AA8DB4C92BAB636E8AF037F43D2FC3C56686A80FB5A53AD50B4CCD215C8EB1A8B971759CA628C67A9C60C26288E212936AA33C588332D4A33BBD3FE258B30E7E1F9DC50B9A8A4AD76825B189A636536BF2364E91F5E2EE801C90BC52808B5652D97B6384CB955CB6BF5732A1DA95C2EFF2E6E3AB6128A21A817D467A05428F34176CB5401ADD3659531445162B8D18E229A86CC9E97ECD4F91DB5499F8FE81C069E22B89680340369E9BA6DEE4E8761F5B97E879147CCFE8761A1FBDC8761E3D07AD73719B526BAF3ABAE1B4D5ED63B889D8FFA1268B253E7BE18E865F1FAB9C093D9B63FEC8C549F1B742F7D0CED44A69D45959CD71ABC5A6930ABD1A1650ED68B344A2AD7EDD1E9342423F385BDB1692F79AC8F944EF2E4D7A97E12A9970CFDF8B4BB86BAA4024F75E750EE168322CF776B07B5127FBEC47540F627D00E92FE74C9050EF7E482BDE9EF744409C0B55E30418CCC30177909C03DDC3F38541A4A5F4E73C7E33CA05D3A3CAF5E4113842D8934EB337A2CEC0925FE234A7E08D1E2C7359C7A762B5EDD1E992DD6D60CB7602CBD43F0FCF27F007F8B2D94FF2B50688FE7310BF062E8FE99D11D39E35FEF0BD21DE73201A73C72F69DBFB6D439E806CD5EF5F16F174E9AEFE975E73E96DAD8FBAC99525F6A4B62EBED5B6ED2B07107A4E654CF026A2D72BFAD4BBA1E9BDB4E6BB32A7151007AD542AE52FDD9A42CBD512DD8F6667F99F2EF5755F1355E83DBC5AB75A5DE178248157394ED5F1228E667DDD661627BB0F48B9FAF0C14D3FBA4BF477F4360E97E84AF0997550FC1AD03C6DC6ED14BB896C24CFB130E5B3B257F07C25DF6411E6F9E1E2DED0163ABC5DE693171B6D4E30D5D185B13C6C4D5D42430F1B4095C4F59B85BC47EB90E50EBD01A15EEB53D1FBDFBB1D52E4FD5A259D5ECB1147FD4BCA794EED6347974EDEAC16D2A583691562A68AE26F53F8B1751B2470B4B2F1F41B86A7C730CC1929379CD427E81CCB0DF0A54D59A319B4565C454242A9728D7FB091608DED0E8381164867C01D33E8697A9FCE8A7F892E3347CC0C1985DA6224E05A88CC307DAFA8848C6DD55FB677DBAB6CC83CB38FBD6671B2A80984496012ED98794D0A092FBCCF0C2B0B09001BD78ADCAB314F2D53A5F569C2E22D6915161BE2A0FDDE030A6C08C5FB2297AC29BC876CBF1399E237F595601ED4CD61F44DBEC831382E6090A79C1A3A6879F80E1205CBCFB0F2CB277647A2F0000 , N'6.1.3-40302')
END

